{% extends "base.html" %}
{% block title %}ì¹´í˜ ìë™í™” - ëŒ€ì‹œë³´ë“œ{% endblock %}

{% block head %}
{{ super() }}
<style>
    .dashboard-container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
    }
    
    /* í†µê³„ ì¹´ë“œ ê·¸ë¦¬ë“œ */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .stat-card {
        background: white;
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
    }
    
    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--card-color);
    }
    
    .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    }
    
    .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        margin-bottom: 12px;
        background: var(--card-color);
        color: white;
    }
    
    .stat-value {
        font-size: 2rem;
        font-weight: 800;
        color: #2d3436;
        margin-bottom: 5px;
    }
    
    .stat-label {
        color: #636e72;
        font-size: 0.9rem;
        font-weight: 600;
    }
    
    /* PC ìƒíƒœ ì¹´ë“œ */
    .pc-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .pc-card {
        background: white;
        border-radius: 16px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        position: relative;
        border-left: 4px solid var(--pc-status-color);
    }
    
    .pc-card.online { --pc-status-color: #00b894; }
    .pc-card.busy { --pc-status-color: #fdcb6e; }
    .pc-card.offline { --pc-status-color: #d63031; }
    
    .pc-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }
    
    .pc-name {
        font-weight: 700;
        font-size: 1.1rem;
        color: #2d3436;
    }
    
    .pc-status-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
    }
    
    .pc-status-badge.online {
        background: #d4edda;
        color: #155724;
    }
    
    .pc-status-badge.busy {
        background: #fff3cd;
        color: #856404;
    }
    
    .pc-status-badge.offline {
        background: #f8d7da;
        color: #721c24;
    }
    
    .pc-info {
        display: flex;
        flex-direction: column;
        gap: 8px;
        font-size: 0.9rem;
        color: #636e72;
    }
    
    .pc-info-row {
        display: flex;
        justify-content: space-between;
    }
    
    .pc-info-label {
        font-weight: 600;
    }
    
    .progress-bar-custom {
        height: 6px;
        border-radius: 10px;
        background: #e1e8ed;
        overflow: hidden;
        margin-top: 5px;
    }
    
    .progress-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, #4A90E2, #5BA3F5);
        transition: width 0.3s;
    }
    
    /* ì‘ì—… í í…Œì´ë¸” */
    .table-card {
        background: white;
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        margin-bottom: 30px;
    }
    
    .table-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #e1e8ed;
    }
    
    .table-header h3 {
        font-size: 1.3rem;
        font-weight: 800;
        color: #2d3436;
        margin: 0;
    }
    
    .task-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .task-table thead th {
        background: linear-gradient(135deg, rgba(74, 144, 226, 0.1) 0%, rgba(91, 163, 245, 0.1) 100%);
        padding: 12px;
        text-align: left;
        font-weight: 700;
        color: #2d3436;
        font-size: 0.9rem;
        border-bottom: 2px solid #e1e8ed;
    }
    
    .task-table tbody tr {
        transition: all 0.2s;
        border-bottom: 1px solid #f1f3f5;
    }
    
    .task-table tbody tr:hover {
        background: rgba(74, 144, 226, 0.05);
    }
    
    .task-table tbody td {
        padding: 12px;
        color: #495057;
        font-size: 0.85rem;
    }
    
    .task-badge {
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        display: inline-block;
    }
    
    .task-badge.human {
        background: #e3f2fd;
        color: #1976d2;
    }
    
    .task-badge.ai {
        background: #f3e5f5;
        color: #7b1fa2;
    }
    
    .status-badge {
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
    }
    
    .status-badge.pending {
        background: #fff3cd;
        color: #856404;
    }
    
    .status-badge.assigned {
        background: #cce5ff;
        color: #004085;
    }
    
    .status-badge.in_progress {
        background: #d1ecf1;
        color: #0c5460;
    }
    
    .status-badge.completed {
        background: #d4edda;
        color: #155724;
    }
    
    .status-badge.failed {
        background: #f8d7da;
        color: #721c24;
    }
    
    /* ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ í‘œì‹œ */
    .live-indicator {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: #d4edda;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        color: #155724;
    }
    
    .live-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #28a745;
        animation: pulse-dot 2s infinite;
    }
    
    @keyframes pulse-dot {
        0%, 100% {
            opacity: 1;
            transform: scale(1);
        }
        50% {
            opacity: 0.5;
            transform: scale(1.2);
        }
    }
    
    /* ë¹ˆ ìƒíƒœ */
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #adb5bd;
    }
    
    .empty-state i {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.5;
    }
    
    /* íƒ­ */
    .nav-tabs {
        border-bottom: 2px solid #e1e8ed;
        margin-bottom: 20px;
    }
    
    .nav-tabs .nav-link {
        border: none;
        color: #636e72;
        font-weight: 600;
        padding: 12px 24px;
        transition: all 0.3s;
    }
    
    .nav-tabs .nav-link:hover {
        color: #4A90E2;
        background: rgba(74, 144, 226, 0.05);
    }
    
    .nav-tabs .nav-link.active {
        color: #4A90E2;
        border-bottom: 3px solid #4A90E2;
        background: transparent;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 style="font-weight: 800; color: #2d3436;">
            <i class="bi bi-robot"></i> ì¹´í˜ ìë™í™” ëŒ€ì‹œë³´ë“œ
        </h1>
        <div class="live-indicator">
            <div class="live-dot"></div>
            ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
        </div>
    </div>
    
    <!-- í†µê³„ ì¹´ë“œ -->
    <div class="stats-grid">
        <div class="stat-card" style="--card-color: #00b894;">
            <div class="stat-icon">
                <i class="bi bi-pc-display"></i>
            </div>
            <div class="stat-value">{{ stats.online_pcs }}/{{ stats.total_pcs }}</div>
            <div class="stat-label">ì˜¨ë¼ì¸ PC</div>
        </div>
        
        <div class="stat-card" style="--card-color: #fdcb6e;">
            <div class="stat-icon">
                <i class="bi bi-hourglass-split"></i>
            </div>
            <div class="stat-value">{{ stats.pending_tasks }}</div>
            <div class="stat-label">ëŒ€ê¸° ì¤‘</div>
        </div>
        
        <div class="stat-card" style="--card-color: #0984e3;">
            <div class="stat-icon">
                <i class="bi bi-arrow-repeat"></i>
            </div>
            <div class="stat-value">{{ stats.in_progress_tasks }}</div>
            <div class="stat-label">ì§„í–‰ ì¤‘</div>
        </div>
        
        <div class="stat-card" style="--card-color: #00b894;">
            <div class="stat-icon">
                <i class="bi bi-check-circle"></i>
            </div>
            <div class="stat-value">{{ stats.completed_today }}</div>
            <div class="stat-label">ì˜¤ëŠ˜ ì™„ë£Œ</div>
        </div>
        
        <div class="stat-card" style="--card-color: #d63031;">
            <div class="stat-icon">
                <i class="bi bi-x-circle"></i>
            </div>
            <div class="stat-value">{{ stats.failed_today }}</div>
            <div class="stat-label">ì‹¤íŒ¨</div>
        </div>
    </div>
    
    <!-- PC ìƒíƒœ -->
    <div class="table-card">
        <div class="table-header">
            <h3><i class="bi bi-pc-display-horizontal"></i> ì‘ì—… PC ìƒíƒœ</h3>
            {% if is_admin %}
            <button class="btn btn-primary btn-sm" onclick="location.href='/automation/pcs/manage'">
                <i class="bi bi-gear"></i> PC ê´€ë¦¬
            </button>
            {% endif %}
        </div>
        
        {% if pcs %}
        <div class="pc-grid">
            {% for pc in pcs %}
            <div class="pc-card {{ pc.status }}">
                <div class="pc-header">
                    <div class="pc-name">
                        <i class="bi bi-pc-display"></i> PC #{{ pc.pc_number }} - {{ pc.pc_name }}
                    </div>
                    <span class="pc-status-badge {{ pc.status }}">
                        {% if pc.status == 'online' %}ğŸŸ¢ ì˜¨ë¼ì¸
                        {% elif pc.status == 'busy' %}ğŸŸ¡ ì‘ì—…ì¤‘
                        {% else %}ğŸ”´ ì˜¤í”„ë¼ì¸
                        {% endif %}
                    </span>
                </div>
                
                <div class="pc-info">
                    <div class="pc-info-row">
                        <span class="pc-info-label">IP ì£¼ì†Œ:</span>
                        <span>{{ pc.ip_address }}</span>
                    </div>
                    
                    {% if pc.status != 'offline' %}
                    <div class="pc-info-row">
                        <span class="pc-info-label">CPU:</span>
                        <span>{{ pc.cpu_usage|round(1) if pc.cpu_usage else 0 }}%</span>
                    </div>
                    <div class="progress-bar-custom">
                        <div class="progress-bar-fill" style="width: {{ pc.cpu_usage if pc.cpu_usage else 0 }}%; background: {% if pc.cpu_usage and pc.cpu_usage > 80 %}#d63031{% elif pc.cpu_usage and pc.cpu_usage > 50 %}#fdcb6e{% else %}#00b894{% endif %};"></div>
                    </div>
                    
                    <div class="pc-info-row">
                        <span class="pc-info-label">ë©”ëª¨ë¦¬:</span>
                        <span>{{ pc.memory_usage|round(1) if pc.memory_usage else 0 }}%</span>
                    </div>
                    <div class="progress-bar-custom">
                        <div class="progress-bar-fill" style="width: {{ pc.memory_usage if pc.memory_usage else 0 }}%; background: {% if pc.memory_usage and pc.memory_usage > 80 %}#d63031{% elif pc.memory_usage and pc.memory_usage > 50 %}#fdcb6e{% else %}#00b894{% endif %};"></div>
                    </div>
                    
                    <div class="pc-info-row">
                        <span class="pc-info-label">ë§ˆì§€ë§‰ í†µì‹ :</span>
                        <span>{{ pc.last_heartbeat.strftime('%H:%M:%S') if pc.last_heartbeat else '-' }}</span>
                    </div>
                    {% endif %}
                    
                    {% if pc.current_task_id %}
                    <div class="pc-info-row" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e1e8ed;">
                        <span class="pc-info-label">í˜„ì¬ ì‘ì—…:</span>
                        <span style="color: #0984e3; font-weight: 600;">Task #{{ pc.current_task_id }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state">
            <i class="bi bi-pc-display"></i>
            <p style="font-size: 1.1rem; margin-top: 10px;">ë“±ë¡ëœ PCê°€ ì—†ìŠµë‹ˆë‹¤</p>
            <p style="color: #636e72;">Worker Agent í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ì—¬ PCë¥¼ ë“±ë¡í•˜ì„¸ìš”</p>
        </div>
        {% endif %}
    </div>
    
    <!-- ì‘ì—… í íƒ­ -->
    <div class="table-card">
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" href="#pending-tasks">
                    <i class="bi bi-hourglass-split"></i> ëŒ€ê¸° ì¤‘ ({{ stats.pending_tasks }})
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#in-progress-tasks">
                    <i class="bi bi-arrow-repeat"></i> ì§„í–‰ ì¤‘ ({{ stats.in_progress_tasks }})
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#completed-tasks">
                    <i class="bi bi-check-circle"></i> ì™„ë£Œ ({{ stats.completed_today }})
                </a>
            </li>
        </ul>
        
        <div class="tab-content">
            <!-- ëŒ€ê¸° ì¤‘ -->
            <div class="tab-pane fade show active" id="pending-tasks">
                {% if pending_tasks %}
                <div style="overflow-x: auto;">
                    <table class="task-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ëª¨ë“œ</th>
                                <th>ì‘ì—… ìœ í˜•</th>
                                <th>ìƒí’ˆ</th>
                                <th>í‚¤ì›Œë“œ</th>
                                <th>ì˜ˆì • ì‹œê°„</th>
                                <th>ìƒíƒœ</th>
                                <th>ìš°ì„ ìˆœìœ„</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for task in pending_tasks %}
                            <tr>
                                <td><strong>#{{ task.id }}</strong></td>
                                <td>
                                    <span class="task-badge {{ task.mode }}">
                                        {% if task.mode == 'human' %}
                                        ğŸ‘¤ íœ´ë¨¼
                                        {% else %}
                                        ğŸ¤– AI
                                        {% endif %}
                                    </span>
                                </td>
                                <td>
                                    {% if task.task_type == 'post' %}
                                    ğŸ“ ë³¸ë¬¸
                                    {% elif task.task_type == 'comment' %}
                                    ğŸ’¬ ëŒ“ê¸€
                                    {% else %}
                                    ğŸ’¬ ëŒ€ëŒ“ê¸€
                                    {% endif %}
                                </td>
                                <td>{{ task.schedule.marketing_product.product.name[:30] if task.schedule and task.schedule.marketing_product else '-' }}</td>
                                <td><span class="badge bg-primary">{{ task.schedule.keyword_text if task.schedule else '-' }}</span></td>
                                <td>{{ task.scheduled_time.strftime('%m/%d %H:%M') }}</td>
                                <td><span class="status-badge {{ task.status }}">{{ task.status }}</span></td>
                                <td>
                                    {% if task.priority > 0 %}
                                    <span style="color: #d63031; font-weight: 700;">ë†’ìŒ</span>
                                    {% else %}
                                    ë³´í†µ
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <i class="bi bi-inbox"></i>
                    <p style="font-size: 1.1rem; margin-top: 10px;">ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤</p>
                </div>
                {% endif %}
            </div>
            
            <!-- ì§„í–‰ ì¤‘ -->
            <div class="tab-pane fade" id="in-progress-tasks">
                {% if in_progress_tasks %}
                <div style="overflow-x: auto;">
                    <table class="task-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ëª¨ë“œ</th>
                                <th>ì‘ì—… ìœ í˜•</th>
                                <th>PC</th>
                                <th>ê³„ì •</th>
                                <th>ì‹œì‘ ì‹œê°„</th>
                                <th>ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for task in in_progress_tasks %}
                            <tr>
                                <td><strong>#{{ task.id }}</strong></td>
                                <td>
                                    <span class="task-badge {{ task.mode }}">
                                        {% if task.mode == 'human' %}ğŸ‘¤ íœ´ë¨¼{% else %}ğŸ¤– AI{% endif %}
                                    </span>
                                </td>
                                <td>
                                    {% if task.task_type == 'post' %}ğŸ“ ë³¸ë¬¸
                                    {% elif task.task_type == 'comment' %}ğŸ’¬ ëŒ“ê¸€
                                    {% else %}ğŸ’¬ ëŒ€ëŒ“ê¸€{% endif %}
                                </td>
                                <td>PC #{{ task.assigned_pc.pc_number if task.assigned_pc else '-' }}</td>
                                <td>{{ task.assigned_account.account_id if task.assigned_account else '-' }}</td>
                                <td>{{ task.started_at.strftime('%H:%M:%S') if task.started_at else '-' }}</td>
                                <td><span class="status-badge in_progress">ì§„í–‰ì¤‘</span></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <i class="bi bi-inbox"></i>
                    <p style="font-size: 1.1rem; margin-top: 10px;">ì§„í–‰ ì¤‘ì¸ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤</p>
                </div>
                {% endif %}
            </div>
            
            <!-- ì™„ë£Œ -->
            <div class="tab-pane fade" id="completed-tasks">
                {% if completed_tasks_today %}
                <div style="overflow-x: auto;">
                    <table class="task-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ëª¨ë“œ</th>
                                <th>ì‘ì—… ìœ í˜•</th>
                                <th>ìƒí’ˆ</th>
                                <th>í‚¤ì›Œë“œ</th>
                                <th>ì™„ë£Œ ì‹œê°„</th>
                                <th>URL</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for task in completed_tasks_today %}
                            <tr>
                                <td><strong>#{{ task.id }}</strong></td>
                                <td>
                                    <span class="task-badge {{ task.mode }}">
                                        {% if task.mode == 'human' %}ğŸ‘¤ íœ´ë¨¼{% else %}ğŸ¤– AI{% endif %}
                                    </span>
                                </td>
                                <td>
                                    {% if task.task_type == 'post' %}ğŸ“ ë³¸ë¬¸
                                    {% elif task.task_type == 'comment' %}ğŸ’¬ ëŒ“ê¸€
                                    {% else %}ğŸ’¬ ëŒ€ëŒ“ê¸€{% endif %}
                                </td>
                                <td>{{ task.schedule.marketing_product.product.name[:30] if task.schedule and task.schedule.marketing_product else '-' }}</td>
                                <td><span class="badge bg-primary">{{ task.schedule.keyword_text if task.schedule else '-' }}</span></td>
                                <td>{{ task.completed_at.strftime('%H:%M:%S') if task.completed_at else '-' }}</td>
                                <td>
                                    {% if task.post_url %}
                                    <a href="{{ task.post_url }}" target="_blank" class="btn btn-sm btn-outline-primary">
                                        <i class="bi bi-box-arrow-up-right"></i> ë³´ê¸°
                                    </a>
                                    {% else %}
                                    -
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <i class="bi bi-inbox"></i>
                    <p style="font-size: 1.1rem; margin-top: 10px;">ì˜¤ëŠ˜ ì™„ë£Œëœ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<script>
// WebSocket ì—°ê²° (ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸)
let dashboardWs = null;

function connectDashboardWebSocket() {
    const wsProtocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
    const wsUrl = `${wsProtocol}//${window.location.host}/ws/dashboard`;
    
    dashboardWs = new WebSocket(wsUrl);
    
    dashboardWs.onmessage = (event) => {
        const data = JSON.parse(event.data);
        
        if (data.type === 'pc_status_update') {
            // PC ìƒíƒœ ì—…ë°ì´íŠ¸
            updatePCStatus(data.pc_number, data.status);
        } else if (data.type === 'task_update') {
            // ì‘ì—… ìƒíƒœ ì—…ë°ì´íŠ¸
            updateTaskStatus(data.task_id, data.status);
        } else if (data.type === 'stats_update') {
            // í†µê³„ ì—…ë°ì´íŠ¸
            updateStats(data.stats);
        }
    };
    
    dashboardWs.onclose = () => {
        console.log('WebSocket ì—°ê²° í•´ì œ, 3ì´ˆ í›„ ì¬ì—°ê²°...');
        setTimeout(connectDashboardWebSocket, 3000);
    };
    
    dashboardWs.onerror = (error) => {
        console.error('WebSocket ì˜¤ë¥˜:', error);
    };
}

function updatePCStatus(pcNumber, status) {
    // PC ì¹´ë“œ ì°¾ê¸° ë° ìƒíƒœ ì—…ë°ì´íŠ¸
    const pcCard = document.querySelector(`.pc-card[data-pc="${pcNumber}"]`);
    if (pcCard) {
        pcCard.className = `pc-card ${status}`;
        const badge = pcCard.querySelector('.pc-status-badge');
        if (badge) {
            badge.className = `pc-status-badge ${status}`;
            badge.textContent = status === 'online' ? 'ğŸŸ¢ ì˜¨ë¼ì¸' : status === 'busy' ? 'ğŸŸ¡ ì‘ì—…ì¤‘' : 'ğŸ”´ ì˜¤í”„ë¼ì¸';
        }
    }
}

function updateStats(stats) {
    // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸
    document.querySelectorAll('.stat-value').forEach((el, idx) => {
        const values = [
            `${stats.online_pcs}/${stats.total_pcs}`,
            stats.pending_tasks,
            stats.in_progress_tasks,
            stats.completed_today,
            stats.failed_today
        ];
        if (values[idx] !== undefined) {
            el.textContent = values[idx];
        }
    });
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', function() {
    // WebSocket ì—°ê²° (ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§)
    // connectDashboardWebSocket();
    
    // 30ì´ˆë§ˆë‹¤ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ (ê°„ë‹¨í•œ ë°©ë²•)
    setInterval(() => {
        location.reload();
    }, 30000);
});
</script>
{% endblock %}

